### 4.4 友元

生活中你的家有客厅(Public)，有你的卧室(Private)。客厅所有来的客人都可以进去，但是你的卧室是私有的，也就是说只有你能进去。但是呢，你也可以允许你的好闺蜜好基友进去。

在程序里，有些私有属性 也想让类外特殊的一些函数或者类进行访问，就需要用到友元的技术。

友元的目的就是让一个函数或者类 访问另一个类中私有成员。

友元的关键字为  ==friend==

友元的三种实现

* 全局函数做友元
* 类做友元
* 成员函数做友元



#### 4.4.1 全局函数做友元

```C++
#include <iostream>
#include <string>
using namespace std;

class Building {
	//类内声明 goodGay() 函数是友元
	friend void goodGay(Building& building);
public:
	Building() {
		m_SittingRoom = "我是客厅";
		m_BedRoom = "我是卧室";
	}
public:
	string m_SittingRoom; //客厅
private:
	string m_BedRoom; //卧室
};

//全局函数
void goodGay(Building & building) {
	//希望可以访问Building的私有属性
	cout << "我正在访问：" << building.m_SittingRoom << endl;
	cout << "我正在访问：" << building.m_BedRoom << endl;
	//正确访问了 private 域的成员
}

void test() {
	Building building;
	goodGay(building);
}

int main() {
	test();
	system("pause");
	return 0;
}
```



#### 4.4.2 类做友元

核心语句：`friend class GoodGay;`

```cpp
#include <iostream>
#include <string>
using namespace std;
//类做友元
```

```cpp
class Building;
class GoodGay {
public:
	GoodGay();
	void visit(); //参观函数访问 Building 中的私有属性
	Building* building;
};
class Building {
	friend class GoodGay;//本节代码核心：声明友元类
public:
	Building();//类内声明，类外实现
public:
	string m_SittingRoom; //客厅
private:
	string m_BedRoom; //卧室
};
```

```cpp
//类外写成员函数
Building::Building() {
	m_SittingRoom = "客厅";
	m_BedRoom = "卧室";
}
GoodGay::GoodGay() {
	//创建建筑物对象
	building = new Building;
}
void GoodGay::visit() {
	cout << "GoogGay正在访问：" << building->m_SittingRoom << endl;
	//友元类可以访问私有成员
	cout << "GoogGay正在访问：" << building->m_BedRoom << endl;
}
```

```cpp
void test01() {
	GoodGay gg;
	gg.visit();
}
```

```cpp
int main() {
	test01();
	return 0;
}
```

#### 4.4.3 成员函数做友元

核心语句：`friend void GoodGay::visit();`

```cpp
#include <iostream>
#include <string>
using namespace std;
```

```cpp
class Building;
class GoodGay {
public:
	GoodGay();
	Building* building;
	//希望 visit 函数可以访问 Building 中私有成员
	void visit();
	//希望 visit2 函数不可以访问 Building 中私有成员
	void visit2();
};
```

```cpp
class Building {
	friend void GoodGay::visit();
public:
	Building();
public:
	string m_SittingRoom;
private:
	string m_BedRoom;
};

```

```cpp
//类外实现成员函数
Building::Building() {
	m_SittingRoom = "客厅";
	m_BedRoom = "卧室";
}
GoodGay::GoodGay() {
	building = new Building;
}
void GoodGay::visit() {
	cout << "visit方法访问了：" << building->m_SittingRoom << endl;
	cout << "visit方法访问了：" << building->m_BedRoom << endl;
}
void GoodGay::visit2() {
	cout << "visit方法访问了：" << building->m_SittingRoom << endl;
	//这里不允许访问 Building 的私有成员
	//cout << "visit方法访问了：" << building->m_BedRoom << endl;
}
```

```cpp
void test01() {
	GoodGay gg;
	gg.visit();
}

int main() {
	test01();
	system("pause");
	return 0;
}
```

