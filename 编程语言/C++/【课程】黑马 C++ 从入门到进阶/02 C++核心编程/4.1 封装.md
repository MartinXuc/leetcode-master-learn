### 4.1 封装

#### 4.1.1  封装的意义

封装是C++面向对象三大特性之一

封装的意义：

+ 将属性和行为作为一个整体，表现生活中的事物
+ 将属性和行为加以权限控制

**封装意义一：**

在设计类的时候，属性和行为写在一起，表现事物。

**语法：** `class 类名{   访问权限： 属性  / 行为  };`



**示例1：** 设计一个圆类，求圆的周长

**示例代码：**

```cpp
//圆周率
const double PI = 3.14;

//1、封装的意义
//将属性和行为作为一个整体，用来表现生活中的事物
class Circle {
public:  //访问权限  公共的权限
	//属性
	int m_r;//半径
	//行为
	//获取到圆的周长
	double calculateZC()
	{
		//2 * pi  * r
		//获取圆的周长
		return  2 * PI * m_r;
	}
};

int main() {
	//通过圆类，创建圆的对象（实例化)
	// c1就是一个具体的圆
	Circle c1;
	c1.m_r = 10; //给圆对象的半径 进行赋值操作
	//2 * pi * 10 = = 62.8
	cout << "圆的周长为： " << c1.calculateZC() << endl;

	system("pause");

	return 0;
}
```



**示例2：** 设计一个学生类，属性有姓名和学号，可以给姓名和学号赋值，可以显示学生的姓名和学号

**示例2代码：**

```cpp
class Student {
private:
	string m_name;
	string m_number;
public:
	//设置姓名
	void setName(string name) {
		m_name = name;
	}
	//设置学号
	void setNumber(string number) {
		m_number = number;
	}
	//显示姓名和学号
	void showStudent() {
		cout << "姓名：\t" << m_name << "\t学号\t" << m_number << endl;
	}
};
```

```cpp
#include <iostream>
using namespace std;
class Student{...};
int main() {
	Student s1;
	s1.setName("李狗剩");
	s1.setNumber("123456765");
	s1.showStudent();
	return 0;
}
```



**封装意义二：**

类在设计时，可以把属性和行为放在不同的权限下，加以控制。

访问权限有三种：

+ public        公共权限  类内可以访问  类外可以访问
+ protected  保护权限  类内可以访问  类外不可以访问 儿子可以访问父亲中的保护内容
+ xxxxxxxxxx27 1#include <iostream>2using namespace std;3​4//函数重载的注意事项5//1. 引用作为重载的条件6void func(int& a) { // 若传入字面量，则会不合法报错，因此推荐加上 const 重载一个版本7    cout << "func(int& a)的调用" << endl;8}9void func(const int& a) {10    cout << "func(const int& a)的调用" << endl;11}12​13//2. 函数重载碰到默认参数14void func2(int a) {15    cout << "func2(int a)的调用" << endl;16}17void func2(int a, int b = 10) {18    cout << "func2(int a, int b)的调用" << endl;19}20​21int main() {22    int a = 1;23    func(a);24    func(10);25    //func2(10); //歧义，出错，尽量避免26    return 0;27}cpp

**示例：**

```cpp
class Person
{
    //姓名  公共权限
public:
    string m_Name;

    //汽车  保护权限
protected:
    string m_Car;

    //银行卡密码  私有权限
private:
    int m_Password;
public:
    void func()
    {
        //类内可以随意访问
        m_Name = "张三";
        m_Car = "拖拉机";
        m_Password = 123456;
    }
};
```



#### 4.1.2 struct和class区别

在C++中 struct和class唯一的**区别**就在于 **默认的访问权限不同**

区别：

+ struct 默认权限为公共
+ class   默认权限为私有



```cpp
class C1 {
    int  m_A; //默认是私有权限
};

struct C2 {
    int m_A;  //默认是公共权限
};

int main() {

    C1 c1;
    c1.m_A = 10; //错误，访问权限是私有

    C2 c2;
    c2.m_A = 10; //正确，访问权限是公共

    system("pause");

    return 0;
}
```



#### 4.1.3 成员属性设置为私有

**优点1：** 将所有成员属性设置为私有，可以自己控制读写权限

**优点2：** 对于写权限，我们可以检测数据的有效性（就是 set 方法可以自定义）

**示例：**

```cpp
#include <iostream>
using namespace std;
```

```cpp
class Person {
public:
    //姓名设置可读可写
    void setName(string name) {
        m_Name = name;
    }
    string getName()
    {
        return m_Name;
    }
    //获取年龄 
    int getAge() {
        return m_Age;
    }
    //设置年龄
    void setAge(int age) {
        if (age < 0 || age > 150) {
            cout << "你个老妖精!" << endl;
            return;
        }
        m_Age = age;
    }
    //情人设置为只写
    void setLover(string lover) {
        m_Lover = lover;
    }

private:
    string m_Name; //可读可写  姓名
    int m_Age; //只读  年龄
    string m_Lover; //只写  情人
};
```

```cpp
int main() {
    Person p;
    //姓名设置
    p.setName("张三");
    cout << "姓名： " << p.getName() << endl;

    //年龄设置
    p.setAge(50);
    cout << "年龄： " << p.getAge() << endl;

    //情人设置
    p.setLover("苍井");
    //cout << "情人： " << p.m_Lover << endl;  //只写属性，不可以读取

    system("pause");
    return 0;
}
```



**练习案例1：设计立方体类**

设计立方体类(Cube)

求出立方体的面积和体积

分别用全局函数和成员函数判断两个立方体是否相等。

![1545533548532](./assets/4%20%E7%B1%BB%E5%92%8C%E5%AF%B9%E8%B1%A1/4.%20%E7%B1%BB%E5%92%8C%E5%AF%B9%E8%B1%A1.png)

**代码**：

```cpp
#include <iostream>
using namespace std;

//立方体类设计
//1. 创建立方体类
//2. 设计属性
//3. 设计行为，获取立方体体积和面积
//4. 设计全局函数 和 成员函数判断两个立方体是否相等
```

```cpp
class Cube {
private:
	int m_L;//长
	int m_W;//宽
	int m_H;//高
public:
	//设置长
	void setL(int L) {
		m_L = L;
	}
	//获取长
	int getL() {
		return m_L;
	}
	//设置宽
	void setW(int W) {
		m_W = W;
	}
	//获取宽
	int getW() {
		return m_W;
	}
	//设置高
	void setH(int H) {
		m_H = H;
	}
	//获取高
	int getH() {
		return m_H;
	}
	//获取立方体面积
	int calculateS() {
		return 2 * m_L * m_W + 2 * m_W * m_H + 2 * m_L * m_H;
	}
	//获取立方体体积
	int calculateV() {
		return m_L * m_W * m_H;
	}
	//利用成员函数判断两个立方体是否相等
	bool isSameByClass(Cube& c) {
		if (getL() == c.getL() && \
			getW() == c.getW() && \
			getH() == c.getH()) {
			return true;
		}
		return false;
	}
};
```

```cpp
//利用全局函数判断两个立方体是否相等
bool isSame(Cube &c1, Cube &c2) {
	if (c1.getL() == c2.getL() && \
		c1.getW() == c2.getW() && \
		c1.getH() == c2.getH()) {
		return true;
	}
	return false;
}
```

```cpp
int main() {
	Cube c1; //创建一个立方体对象
	c1.setL(10);
	c1.setW(10);
	c1.setH(10);
	cout << "c1的面积是：" << c1.calculateS() << endl;
	cout << "c1的体积是：" << c1.calculateV() << endl;

	Cube c2; //创建第二个立方体对象
	c2.setL(10);
	c2.setW(10);
	c2.setH(10);

	if (isSame(c1, c2)) {
		cout << "【全局】c1 和 c2 相等" << endl;
	}
	else {
		cout << "【全局】c1 和 c2 不相等" << endl;
	}

	bool ret = c1.isSameByClass(c2);

	if (ret) {
		cout << "【成员】c1 和 c2 相等" << endl;
	}
	else {
		cout << "【成员】c1 和 c2 不相等" << endl;
	}

	return 0;
}
```



**输出结果**：

![](./assets/4%20%E7%B1%BB%E5%92%8C%E5%AF%B9%E8%B1%A1/image-20250306113857884.png)

**练习案例2：点和圆的关系**

设计一个圆形类（Circle），和一个点类（Point），计算点和圆的关系。

![1545533829184](./assets/4%20%E7%B1%BB%E5%92%8C%E5%AF%B9%E8%B1%A1/4.%20%E7%B1%BB%E5%92%8C%E5%AF%B9%E8%B1%A1-1.png)

```cpp
#include <iostream>
using namespace std;

//点和圆关系判断
//点到圆心的距离 == 半径 -> 点在圆上
//点到圆心的距离 > 半径 -> 点在圆外
//点到圆心的距离 < 半径 -> 垫在院内
```

```cpp
class Point {
private:
	int m_x;
	int m_y;
public:
	void setX(int x) {
		m_x = x;
	}
	void setY(int y) {
		m_y = y;
	}
	int getX() {
		return m_x;
	}
	int getY() {
		return m_y;
	}
	void setXY(int x, int y) {
		m_x = x;
		m_y = y;
	}
};
```

```cpp
class Circle {
private:
	int m_r; //半径
	Point m_Center; //圆心
public:
	void setR(int r) {
		m_r = r;
	}
	int getR() {
		return m_r;
	}
	void setCenter(int x, int y) {
		m_Center.setX(x);
		m_Center.setY(y);
	}
	Point getCenter() {
		return m_Center;
	}
};
```

```cpp
void isInCircle(Circle& c, Point& p) {
	//计算两点之间距离平方
	int distance2 = (c.getCenter().getX() - p.getX()) * (c.getCenter().getX() - p.getX()) + 
		(c.getCenter().getY() - p.getY()) * (c.getCenter().getY() - p.getY());
	int r2 = c.getR() * c.getR();
	if (distance2 > r2) {
		cout << "点在圆外" << endl;
	}
	else if (distance2 == r2) {
		cout << "点在圆上" << endl;
	}
	else {
		cout << "点在圆内" << endl;
	}
}
```

```cpp
int main() {
	Circle c;
	Point pOut;
	Point pIn;
	Point pOn;
	c.setCenter(10, 0);
	c.setR(10); 
	pOut.setXY(10, 11);
	pIn.setXY(10, 10);
	pOn.setXY(10, 9);
	isInCircle(c, pOut);
	isInCircle(c, pIn);
	isInCircle(c, pOn);
	return 0;
}
```

